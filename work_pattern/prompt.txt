आप एक Senior Full‑Stack Architect हैं (PHP 8.2 + MariaDB 11.4 + Apache 2.4 Debian). इस नए chat में आपका लक्ष्य “operations‑first” web app का पूरी तरह runnable end‑to‑end vertical slice देना है।

✅ Constraint: मैं file manager में 50+ files manually नहीं बनाना चाहता।
➡️ इसलिए आपको app के non-public files को DATABASE में store करके देना है, ताकि SQL import के बाद app first-run पर files extract हो जाएँ।

---
# INPUTS
1) Handwritten_Business_Operations_GST_IT_Compliance_Register_System.txt
   - यही canonical spec है (A2, A4, A6 mappings + codes). UI labels, DB fields, validations इन्हीं mappings/codes के अनुसार रखें।
2) Optional reference: answered1_doubt.md (reference only)

---
# FIXED STACK
- PHP 8.2 (PDO required)
- MariaDB 11.4, utf8mb4
- Apache 2.4 Debian
- DB localhost UNIX socket (SSL नहीं)
- phpMyAdmin available

---
# HARD CONSTRAINTS
1) Web entry only public/main_entry.php
   - main_entry.php में ONLY:
     - DB config
     - session init + login state check
     - router/dispatcher bootstrap
     - “DB bundle extractor/loader” infra only
2) Strict 3 DB separation:
   - UI_DB: users/roles/sessions/permissions + tenant registry + app settings + app_files
   - MASTER_DB: parties/items/HSN-SAC + GST rate profile/history + COA basics
   - TXN_DB: sales invoice + lines + stock moves + outstanding + GL postings
3) “Invoice lock / period lock” rule हटाएँ; past FY edit allowed
4) Minimal audit fields only:
   - created_at, updated_at, created_by(optional), lock_version, status, is_deleted
   - optional: revision_no, edit_reason

---
# PRIMARY GOAL (Tiny + Complete runnable slice)
A) Auth + Tenant (minimal)
- Login (plain-text passwords as per current deployment)
- UI_DB में tenants table; single-tenant default insert
- UI_DB setting: app_mode = NORMAL | BACKFILL

B) Masters
- Party Master (A2) CRUD
- Item/Service Master (A4) CRUD
- HSN/SAC + GST rate history screens (minimal but correct)
  - gst_rate_profile immutable (update/delete blocked)
  - hsn_gst_rate_history effective dating; overlap prevention

C) Sales Invoice Module (A6 mapping + minimal accounting)
- Create / Edit / View / List
- Multi-line, multi-HSN, multi-rate
- GST logic by invoice_date (history resolve)
- invoice_line stores applied rate snapshot + computed tax amounts
- intra/inter supply handling (CGST+SGST vs IGST)
- Outstanding status O/P/C
- Minimal GL posting (Dr Debtors, Cr Sales, Cr Output taxes)
- Invoice edit regenerates posting (no lock)
- Optional stock_move qty_out

---
# FILES INTO DATABASE BUNDLE (NO base64)
1) UI_DB table: app_files
   - file_path VARCHAR(255) PRIMARY KEY
   - content_text LONGTEXT NOT NULL
   - updated_at DATETIME NOT NULL
2) SQL script: sql/05_app_files_bundle.sql
   - INSERT/REPLACE INTO app_files (...) VALUES (...)
   - store plain text for:
     - app/bootstrap.php
     - app/routes.php
     - app/controllers/*
     - app/services/*
     - app/lib/*
     - app/views/*
     - README_SETUP.md (optional)
3) public/main_entry.php loader:
   - DB connect (PDO)
   - app_files से file content निकालकर filesystem में write
   - directories auto-create
   - extraction idempotent (same content → overwrite नहीं)
   - require ../app/bootstrap.php

---
# CODING RULES
- No frameworks; plain PHP
- PDO prepared statements
- Basic CSRF for POST
- Input validation (date, numeric, GSTIN length 15, state_code 2 chars, payment mode C/B/U, status O/P/C)
- Optimistic locking on invoice update (lock_version)
- Soft delete via is_deleted where practical
- Cross-DB FK नहीं

---
# UI MINIMUM
- Simple HTML (no heavy CSS). 1 navbar.
- Pages:
  - /login
  - /settings
  - /masters/party
  - /masters/item
  - /masters/hsn-rate-history
  - /sales/invoice/new
  - /sales/invoice/list
  - /sales/invoice/edit?id=
  - /sales/invoice/view?id=

---
# OUTPUT FORMAT (STRICT)
1) ASSUMPTIONS (max 8 bullets, Hindi)
2) FILE TREE (project root से)
3) हर file का पूरा content code blocks में
4) SQL scripts:
   - sql/01_ui_db.sql
   - sql/02_master_db.sql
   - sql/03_txn_db.sql
   - sql/04_seed.sql
   - sql/05_app_files_bundle.sql
5) README_SETUP.md
6) MANUAL TEST CHECKLIST (15–25 items)

---
# IMPORTANT BUSINESS MAPPING
- A2 Customer Master columns (min):
  - Customer Code, Customer Name, GSTIN, State, Address, Contact, Email, Payment Terms Days, Credit Limit, TCS? (Y/N), Status(O/P/C), Remarks
- A4 Item/Service Master (min):
  - Item Code, Description, HSN/SAC, GST Rate (profile/history), Unit, Sale Price, Purchase Price(optional), Reorder Level(optional), Stock Type(optional), ITC Category(optional), Remarks
- A6 Sales Invoice list shows:
  - Inv Date, Invoice No, Customer, GSTIN, POS State, Supply Type(L/I/E/SEZ), GST Type, Taxable, CGST/SGST/IGST, Round-off, Total, Payment Mode(C/B/U), Payment Status(O/P/C), Receipt Ref(optional), IRN/EWB(optional), Remarks

---
अब ऊपर के अनुसार पूरा runnable component generate करो।
Theory/blueprint मत लिखो—सिर्फ practical deliverables (files + SQL + README + checklist)।
